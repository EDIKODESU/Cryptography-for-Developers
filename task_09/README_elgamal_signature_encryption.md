# Програмна реалізація алгоритму Ель-Гамаля, цифрового підпису, спрямованого шифрування
Цей проект містить завдання власної реалізації цифрового підпису, спрямованого шифрування та перевірки коректності реалізації


## Загальні відомості про завдання
Для виконання практичного завдання вам треба дослідити алгоритм Ель-Гамаля використовуючи будь-які відкриті джерела за вашим бажанням. Запрограмувати відповідні алгоритми створення цифрового підпису, перевірки підпису, зашифрування повідомленні і його розшифрування. Зробити програмну перевірку коректності вашої реалізації шляхом накладання підпису та його перевірки, а також співпадіння оригінального повідомлення з тим що було зашифровано та розшифровано.
Під час створення власної програмної реалізації алгоритмів можете використати результати своїх попередніх завдань для роботи з великими числами, генерацією випадкових послідовностей тощо. В головній функції свого програмного проекту зробіть демонстраційний виклик реалізованих функцій.
Наведемо декілька порад щодо власної програмної реалізації алгоритму Ель-Гамаля. Спочатку треба вивчити деталі алгоритму, ретельно ознайомитися з принципом роботи, його математичними основами та усіма необхідними кроками (вибір параметрів, генерація ключів та інші).
Використовуйте зручну мову програмування та свої наробки з попередніх практичних завдань. Зверніть увагу на підтримку математичних операцій, які знадобляться для роботи з числовими операціями у скінченних полях. Забезпечте правильність математичних операцій і переконайтесь, що ваша програмна реалізація коректно їх використовує (піднесення до ступеню, множення та ділення у скінченних полях). Реалізуйте гешування повідомлення перед підписом (цифровий підпис зазвичай накладається на геш-значення) та розбиття повідомлення на блоки для зашифрування.

## 2.1 Власна реалізація цифрового підпису
  Напишіть власну програмну реалізацію цифрового підпису за алгоритмом Ель-Гамаля. Зверніть увагу на порядок вибору загальносистемних параметрів та генерацію ключів відповідно до них. Наведемо кроки алгоритму для кожного з епатів.

Вибір загальносистемних параметрів:
+ Згенеруйте випадкове просте число p довжиною від 2048 до 4096 бітів, яке служить модулем для арифметичних операцій у скінченному полі.
+ Виберіть випадкове число g, яке є примітивним коренем модуля p, і воно має генерувати всі елементи поля від 1 до p-1.

Генерація ключів:
+ Оберіть випадкове число a (особистий ключ), що належить інтервалу (1, p-1).
+ Обчисліть відкритий ключ b = g^a mod p.

Підписання повідомлення:
+ Оберіть випадкове число k, яке належить інтервалу (1, p-1).
+ Обчисліть перший компонент підпису: r = g^k mod p.
+ Обчисліть другий компонент підпису: s = (H(m) - a*r) * k^(-1) mod (p-1), де H(m) – геш-значення від повідомлення m.
+ Підписом повідомлення буде пара значень (r, s).

Перевірка підпису:
+ Обчисліть обернений елемент до відкритого ключа: y = b^(-1) mod p.
+ Обчисліть першу складову перевірки: u1 = (H(m) * s^(-1)) mod (p-1).
+ Обчисліть другу складову перевірки: u2 = (r * s^(-1)) mod (p-1).
+ Обчисліть перевірочне значення: v = (g^u1 * y^u2) mod p.
+ Підпис вважається вірним, якщо v = r.

## 2.2 Власна реалізація спрямованого шифрування
 Напишіть власну програмну реалізацію спрямованого шифрування за алгоритмом Ель-Гамаля. Зверніть увагу на розбиття повідомлення на блоки і шифрування кожного блока окремо. Якщо ви вже реалізували відповідний алгоритм цифрового підпису, з шифруванням вам буде значно простіше. Наведемо кроки алгоритму для кожного з епатів.

Вибір загальносистемних параметрів:
+ Згенеруйте випадкове просте число p з довжиною від 2048 до 4096 бітів, яке служить модулем для арифметичних операцій у скінченному полі.
+ Виберіть випадкове число g, яке є примітивним коренем модуля p, і воно має генерувати всі елементи від 1 до p-1.

Генерація ключів:
+ Оберіть випадкове число a (особистий ключ), що належить інтервалу (1, p-1).
+ Обчисліть відкритий ключ b = g^a mod p.

Зашифрування повідомлення:
+ Відправник обирає повідомлення m, яке потрібно зашифрувати, і випадкове число k, яке необхідне для шифрування
+ x = g^k mod p
+ y = (b^k * m) mod p
+ де m – числове представлення повідомлення
+ Відправник відправляє шифротекст (x, y) одержувачу

Розшифрування повідомлення:
+ Отримавши шифротекст (x, y), одержувач може розшифрувати повідомлення за допомогою свого особистого ключа a
+ s = x^a mod p
+ m = (y * (s^(-1))) mod p, де s^(-1) – обернене до s в полі за модулем p
+ m – розшифроване повідомлення


## Перевірка коректності реалізації
Метою цього етапу є виклик функцій підпису і перевірки зі згенерованими вами ключами для певного тестового повідомлення. І переконання в тому, що цифровий підпис правильний. А також перевірка цього сценарію з пошкодженними даними і впевненість, що алгоритм перевірки підпису повертає «false».
Для спрямованого шифрування достатньо перевірити, що зашифроване вашою функцією повідомлення правильно розшифровується. З урахуванням того, що від початку повідомлення може бути значно більше аніж модуль p і його треба розбивати на блоки.

## Запуск Коду
Для запуску цього коду на Python, слід дотримуватися наступних кроків:
1. Встановіть Python на вашому комп'ютері, якщо він ще не встановлений. Можна завантажити Python з [офіційного сайту](https://www.python.org/downloads/).
2. Клонуйте цей репозиторій на свій комп'ютер.
3. Перейдіть до каталогу з кодом.
4. Встановіть залежності, якщо вони є, використовуючи pip.
5. Запустіть код: python elgamal_signature_encryption.py.

## Приклад Результату
Вихідна програма виведе результати гешованих даних, перевірку з бібліотечним аналогом за часом та значеннями. Наприклад:
```
Prime: 29798456296696037226875251567509206811497416722223871111250404748625751917283683803273550079224705747674426141783147069387809209463577485370585414049697994093454345491978772227125275675008244572637330311179877885172942971122791670251158156520713058864769265329293023840490943139191846213229938502056099808738105687687925627946315995895478401557041329354420000407301046199669379456175553355874077824288686120493800021644728479783597631329365669532631718420195983472631025028450266532375676535610087981055853274198862373688850815992065036752800162901284399387862544321488425330167510128150036715766411687820393813611403
Primitive Root: 24719408551597399356632866094455081264968006560799493182448537088072560884860561634664041997178936812440302730924893505149707930523354633068657079453893972440066187360898209633244587871529088368015930549549327338486946274788320075158317059837463487459707377150030916837949886969556911596287730120251655161400503596653217677352839773632554135212265312269952478870129445482902159526946323394555602821178821476248188567119430372389858036787413988782875072528216638395427090812713003497554686398461729366179593954736372004341542244847197280723020903907900738500220454302366506057845302290165847184323703252205634448710901
Original Message 1: Hello, World!
Signature (r, s): (6693929580503734908319751607586004931674099078897934697584848520588708334039315139836572555057962382319854366731689072253945598620443076724713249015692557073972310060547614637673358552291755793920860173444221915010177611924912789599081547159554923859840801190625038716122833557148351636524363371505755384039769488757556869755930768083346798591451536590331754054541832058853417318569565530240189922936904781983309798135687739024870535267826133748270476249482458746071295062094036028785565058494875998171481501551699842501524449107145246741034478720412698787654295048122155108077618841038193740827552427552167494905046, 4969909484283294569787795203594586406713873984300585268515041375563328940498318301467968824781232912193158156193663378948418433734711487688457409388234262422092432696133969798928325751082411036127502072072120369160946296315582177656575240135852124017259279346201675010631854840093622460003118984556608943378378004049261062457847992942880475176778741421759422717851793334924550557760748013541002302049023704252930441211136458800494214413568895882539267666054655984010546363000412597071471416361691873948850630397482200351435504200284723168846575016059208551079525884510345345064782023579668201799644335377982145869345)
Signature Verified: False

Original Message 2: 42
Ciphertext (x, y): (29576922438069376686068983670735384779743580615181018574742912783021164928564418429610033873800998443053059292017514277038802064238171613793975216333361471599763923309582616197545677519647592766648243615253871695283812629542848479181024733607123764496403812330245393224440474027349213492049733096212843600436326506314598890169441272133696180475783945581489930823303844321329406736181791753156764160161627002001254915469647335866762913671662284961154578280706566828489999014137674235855441501753030810235858426044446132410616514750377096135431296170233225019037738592219870687035262957716116935433194518664645551187769, 2301838217459488298367428751257283096050610697711260352469945745660638273698320922535014531991729280395358025804982353893498409761782213917030339859518459691868060458246670193147046517698118100371242530212589102085983354623196099053111955394895783596796325308791456877571306105709643620881489582885843425142210771484962870330185060729052178184329437620285391962513389051497516952220103648916218703745965784285544784746265022048229324291731954717173437217798911096034457527736102054544597806563844743962611456506693450909602439320838657003335129920255310327000517361872839515545725397543769501954932322279355602570699)
Decrypted Message: 42
```
